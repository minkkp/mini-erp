# 생산 및 재고 관리를 위한 미니 ERP 프로젝트

본 프로젝트는  
생산 및 재고 관리 도메인에서 발생하는 **정합성 문제를 설계로 해결하는 것**에  
초점을 둔 백엔드 중심 토이 프로젝트입니다.

대규모 트래픽 처리보다는,  
재고·생산 흐름에서의 **트랜잭션 경계, 실패 전략, 데이터 무결성**을  
명확하게 정의하는 데 집중했습니다.

---

## 🛠 기술 스택

### Backend
- Java 17
- Spring Boot
- Spring Data JPA
- PostgreSQL

### Frontend (보조)
- React
- TypeScript  
※ 백엔드 API 흐름 검증용

---

## 📌 프로젝트 목적

- 생산·재고 관리 도메인에서 발생하는 정합성 문제 직접 구현
- 생산 처리 과정에서의 트랜잭션 설계 경험
- 동시 수정 상황에서 데이터 무결성을 유지하는 설계 학습
- 과도한 기술 적용이 아닌, 도메인에 맞는 기술 선택 연습

---

## 🧠 핵심 설계 포인트

### 1. 재고 동시성 제어
- `Stock` 엔티티에 **Optimistic Lock(@Version)** 적용
- 동시 수정 시 충돌을 감지하고 명확한 실패 처리
- 자동 재시도 대신 사용자 재시도 유도 전략 선택

### 2. 생산 처리 단일 트랜잭션
생산 실적 등록 시 다음 작업을 하나의 트랜잭션으로 처리합니다.

- 자재 재고 차감
- 생산 실적 저장
- 완제품 재고 증가
- 재고 변경 이력 기록

중간 단계에서 오류 발생 시 전체 롤백되도록 설계했습니다.

### 3. 음수 재고 방지
- 재고 차감은 엔티티 내부 로직에서 검증
- 잘못된 상태가 DB에 저장되지 않도록 도메인 레벨에서 차단

---

## 🏗 도메인 구성

- **Stock**  
  품목 + 창고 기준의 현재 재고 상태

- **StockHistory**  
  입고, 생산 등 모든 재고 변경 이력 저장

- **Production**  
  생산 실적 정보

- **ProductionMaterial**  
  생산 시 투입된 자재 정보

재고는 현재 상태만 유지하고,  
모든 변경 내역은 이력 테이블에 누적 저장하는 구조입니다.

---

## 🔄 생산 처리 흐름

1. 생산 품목 및 창고 유효성 검증  
2. 자재 재고 차감 (Optimistic Lock 적용)  
3. 생산 실적 저장  
4. 완제품 재고 증가  
5. 재고 변경 이력 기록  

모든 과정은 단일 트랜잭션으로 처리됩니다.

---

## 🚨 동시성 및 실패 전략

- 동시 수정 충돌 발생 시  
  - Optimistic Lock 예외 발생  
  - HTTP 409 응답 반환  
  - 사용자 재시도 유도  

정합성이 중요한 도메인 특성상  
조용한 자동 재시도보다 **명확한 실패를 우선**하는 전략을 선택했습니다.

---

## ⚙ 재고 스냅샷 배치 처리

- 일 단위 재고 집계를 위한 스냅샷 테이블 운영
- 배치 실행 시 전체 재고 기준으로 스냅샷 생성
- `(item_id, warehouse_id, snapshot_date)` 유니크 제약 적용  
  - 동일 날짜에 여러 번 실행해도 결과가 동일하도록 설계

토이 프로젝트 특성상 `findAll()` 기반으로 구현했으며,  
운영 환경에서는 페이징 또는 파티셔닝 확장 가능성을 고려했습니다.

---

## 🖥 주요 화면

### 생산 실적 등록

### 자재 입고 및 재고 조회

---

## 🗺 ERD


---

## 🖥 프론트엔드 구성 (보조)

프론트엔드는 UI 완성도보다는  
백엔드 API 흐름과 업무 시나리오 검증을 목적으로 구현했습니다.

- React + TypeScript 기반
- API 레이어 분리
- DTO 기준 타입 정의로 데이터 구조 일관성 유지
- 생산, 입고, 재고 흐름을 화면에서 직접 확인 가능

---

## ✍ 마무리

이 프로젝트를 통해  
생산·재고 관리 도메인에서 정합성과 트랜잭션 설계가  
왜 중요한지 직접 경험할 수 있었습니다.

단순 CRUD를 넘어  
**도메인 규칙을 중심으로 한 백엔드 설계**를 목표로 한 프로젝트입니다.
