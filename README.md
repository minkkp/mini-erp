# 생산 및 재고 관리를 위한 미니 ERP 프로젝트

생산 및 재고 관리 도메인에서 발생하는 동시성 문제와 트랜잭션 정합성을  
Spring Boot + JPA 기반으로 해결하는 백엔드 중심 ERP 미니 프로젝트입니다.
<br><br>
## 🛠 기술 스택

### Backend
- Spring Boot
- Spring Data JPA
- PostgreSQL

### Frontend (백엔드 API 검증 목적)
- React
- TypeScript
<br><br>
## 🎯 프로젝트 목적

- 생산 처리 과정에서 발생할 수 있는 재고 불일치 문제를  
  트랜잭션과 도메인 규칙으로 해결
- 생산 처리 과정에서의 트랜잭션 경계 설계
- 동시 요청 상황에서 데이터 무결성을 유지
<br><br>
## 🧠 핵심 설계

### 재고 동시성 제어

- Stock 엔티티에 낙관적 락(@Version) 적용
- 동시 요청 시 충돌을 감지하고 즉시 실패 처리
- 자동 재시도 대신 사용자 재시도 유도 전략 선택

  
### 생산 처리 단일 트랜잭션

생산 실적 등록 시 다음 작업을 하나의 트랜잭션으로 처리  
(중간 단계에서 오류 발생 시 전체 롤백)

- 자재 재고 차감
- 생산 실적 저장
- 완제품 재고 증가
- 재고 변경 이력 기록
  
### 음수 재고 방지

- 재고 차감은 Stock 엔티티 내부 로직에서 검증
- 잘못된 상태가 DB에 저장되지 않도록 도메인 레벨에서 차단
<br><br>
## 🧩 도메인 구성

- Stock  
  품목 및 창고 기준 현재 재고

- StockHistory  
  입고, 생산 등 모든 재고 변경 이력 저장

- Production  
  생산 실적 정보

- ProductionMaterial  
  생산 시 투입된 자재 정보

재고는 현재 상태만 유지하고,  
모든 변경 사항은 이력 테이블에 누적 저장하는 구조입니다.
<br><br>
## 🔄 생산 처리 흐름

1. 생산 품목 및 창고 유효성 검증
2. 자재 재고 차감 (낙관적 락 적용)
3. 생산 실적 저장
4. 완제품 재고 증가
5. 재고 변경 이력 기록

모든 과정은 단일 트랜잭션으로 처리됩니다.
<br><br>
## 🚨 동시성 및 실패 전략

- 재고 동시 수정 충돌 발생 시
  - Optimistic Lock 예외 발생
  - HTTP 409 응답 반환
  - 사용자 재시도 유도

정합성이 중요한 도메인 특성상  
조용한 자동 재시도보다 명확한 실패를 우선하는 전략을 선택했습니다.
<br><br>
## 📊 재고 스냅샷 배치 처리

- 일 단위 재고 집계를 위한 스냅샷 테이블 운영
- 배치 실행 시 전체 재고 기준으로 스냅샷 생성
- (item_id, warehouse_id, snapshot_date) 유니크 제약 적용
  - 동일 날짜에 여러 번 실행해도 결과가 동일하도록 설계

토이 프로젝트 특성상 findAll() 기반으로 구현했으며,  
운영 환경에서는 페이징 또는 파티셔닝 확장 가능성을 고려했습니다.
<br><br>
## 🖥 주요 화면

### 생산 실적 등록
(이미지)

### 자재 입고 및 재고 조회
(이미지)

  
## 🗂 ERD

(이미지)

- 재고는 현재 상태와 변경 이력을 분리하여 관리
- 생산 처리 시 자재 차감과 완제품 증가 흐름을 명확히 표현
- 일 단위 재고 집계를 위해 StockDailySnapshot 테이블 구성
<br><br>
## 🧪 프론트엔드 구성 (보조)

백엔드 API 흐름과 업무 시나리오 검증을 목적으로 구현했습니다.

- React + TypeScript 기반
- API 레이어 분리
- DTO 기준 타입 정의로 데이터 구조 일관성 유지
- 생산, 입고, 재고 흐름을 화면에서 직접 확인 가능
<br><br>
## ✍ 마무리

이 프로젝트를 통해  
생산 및 재고 관리 도메인에서 정합성과 트랜잭션 설계가  
왜 중요한지 직접 경험할 수 있었습니다.

단순 CRUD 구현을 넘어  
도메인 규칙을 중심으로 한 백엔드 설계를 목표로 한 프로젝트입니다.
